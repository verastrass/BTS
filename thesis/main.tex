\input{preamble.tex}
\NewBibliographyString{langjapanese}
\NewBibliographyString{fromjapanese}

\begin{document}
\Intro
В~современном мире распределённые системы являются основой различных объектов, например, веб-сервисов и пиринговых сетей. Поскольку обмен сообщениями в~системе осуществляется по~ненадёжным каналам связи, сообщения, посылаемые системе или самой системой, могут просматриваться, перехватываться и подменяться. Это приводит к~неправильному функционированию системы, отказу отдельных компонент или системы в~целом. Поэтому в~распределённых системах поддержке безопасности уделяется особое внимание.

Для~повышения надёжности системы случайные и умышленные сбои в~системе интерпретируются как Византийские ошибки (в~терминах <<Задачи о~Византийских генералах>>). В~этом случае можно использовать соответствующие отказоустойчивые техники, которые защитят систему и от~случайных, и от~умышленных сбоев.

В~данной работе рассматривается Византийское пространство кортежей~--- открытая распределённая устойчивая к~Византийским ошибкам система, основанная на~пространстве кортежей без~распределённой памяти, в~которой процессы взаимодействуют путём~обмена сообщениями.


\pagebreak


\section{Распределённые вычислительные системы}\label{sec:1}
Распределённая вычислительная система~--- это набор независимых компьютеров, реализующий параллельную обработку данных на~многих вычислительных узлах. С~точки зрения пользователя этот набор является единым механизмом, предоставляющим полный доступ к~ресурсам. Существует возможность добавления новых ресурсов, свойст и методов, возможность перераспределения ресурсов по~системе, но информация об~этих событиях скрыта от~пользователя \autocite{Tanenbaum}.

Распределённая система, рассматриваемая в~данной работе, представлена множеством из~n~серверов. Взаимодействие клиентов с~системой происходит с~помощью вспомогательной промежуточной инфраструктуры, как показано на~рисунке\,\ref{clser}.
\begin{figure}[H]
	\centering \includegraphics[width=0.7 \textwidth, height=0.5 \textwidth]{img/ClientServer}  \caption{Взаимодействие клиентов с~распределённой системой} \label{clser}
\end{figure}

Одной из~важнейших характеристик распределённых систем является отказоустойчивость. Отказоустойчивость~--- это свойство системы сохранять работоспособность в~том случае, если какие-либо составляющие её компоненты перестали правильно функционировать. Компоненты системы могут стать нероботоспособны по~различным причинам, например, из-за~технологических сбоев или атак безопасности.

Большинство современных распределённых систем имеют характеристики открытых систем. Открытая распределённая система предполагает использование служб, вызов которых требует стандартного синтаксиса и семантики. Такая система может иметь неизвестное количество ненадёжных и неоднородных участников, то~есть участникам не нужно быть активными одновременно (свойство разъединённости во~времени) и не обязательно знать друг о~друге (свойство разъединённости в~пространстве). Связь между~узлами распределённой системы является ненадёжной (может прерываться, что повлечёт за~собой потерю сообщений), обмен сообщениями может происходить не мгновенно, а с~существенной задержкой. Кроме~того, любой узел системы может отказать или быть выключен в~любой момент времени. Все эти факторы неизбежно приводят к~неправильному функционированию системы. Один из~способов улучшить её надёжность~--- это интерпретировать случайные или умышленные неполадки как~Византийские ошибки (в~терминах <<Задачи византийских генералов>>), тогда использование отказоустойчивых техник сможет сделать координационную составляющую системы отказоустойчивой и для~случайных сбоев, и для~умышленных вторжений.

\section{Задача византийских генералов}\label{sec:2}
Задача византийских генералов~--- это задача взаимодействия нескольких удалённых абонентов, получивших сообщения из~одного центра, причём часть этих абонентов, в~том числе центр, могут быть предателями, то~есть могут посылать заведомо ложные сообщения с~целью дезинформирования. Нахождение решения задачи заключается в~выработке единой стратегии действий, которая будет являться выигрышной для~всех абонентов.

Формулировка задачи состоит в~следующем. Византийская армия представляет собой объединение некоторого числа легионов, каждым из~которых командует свой генерал, генералы подчиняются главнокомандующему армии Византии. Поскольку империя находится в~упадке, любой из~генералов и даже главнокомандующий могут быть заинтересованы в~поражении армии, то~есть являться предателями. Генералов, не заинтересованных в~поражении армии, будем называть верными. В~ночь перед~сражением каждый из~генералов получает от~главнокомандующего приказ о~действиях во~время сражения: атаковать или отступать. Таким образом, имеем три возможных исхода сражения:
\begin{itemize}
	\item Благоприятный исход: все генералы атакуют противника, что приведёт к~его уничтожению и победе Византии.
	\item Промежуточный исход: все генералы отступят, тогда противник не будет побеждён, но Византия сохранит свою армию.
	\item Неблагоприятный исход: некоторые генералы атакуют противника, некоторые отступят, тогда Византийская армии потерпит поражение.
\end{itemize}

Так~как главнокомандующий тоже может оказаться предателем, то генералам не следует доверять его приказам. Однако если каждый генерал будет действовать самостоятельно, независимо от~других генералов, то вероятность наступления боагоприятного исхода становится низкой. Таким образом, генералам следует обмениваться информацией между~собой для~того, чтобы прийти к~единому решению.

На~практике задача византийских генералов решается с~помощью алгоритмов консенсуса, ярким представителем которых является алгоритм Паксос, предложенный Лесли Лампортом.

\section{Paxos}\label{sec:3}
Paxos~--- это алгоритм для~решения задачи консенсуса в~сети ненадёжных вычислителей. Компоненты распределённой системы можно разделить на~3 группы:
\begin{itemize}
	\item Заявитель (Proposer)~--- выдвигает <<предложения>> (какие-либо значения), которые либо принимаются, либо отвергаются в~результате работы алгоритма консенсуса.
	\item Акцептор (Acceptor)~--- принимает или отвергает <<предложение>> Заявителя, согласует своё решение с~остальными Акцепторами, уведомляет о~своём решении Узнающих. Если Акцепторами было принято какое-либо значение, предложенное Заявителем, то оно называется утверждённым.
	\item Узнающий (Learner)~--- запоминает решения Акцепторов, принятые в~результате работы алгоритма консенсуса.
\end{itemize}

Компоненты распределённой системы могут принадлежать сразу нескольким группам, описанным выше, и вести себя и как Заявитель, и как Акцептор, и как Узнающий.

Такое распределение ролей в~системе гарантирует следующее:
\begin{itemize}
	\item Только предложенное Заявителем значение может быть утверждено Акцепторами.
	\item Акцепторами утверждается только одно значение из~всех предложенных Заявителями значений (возможно, противоречивых).
	\item Узнающий не сможет узнать об~утверждении какого-либо значения вплоть до~того момента, пока оно действительно не будет утверждено.
\end{itemize}




\section{Пространство кортежей}\label{sec:4}
Кортеж~--- это структура данных, представляющая собой неизменяемый список фиксированной длины, элементы которого могут относиться к~различным типам данных. Два кортежа считаются равными, если совпадают их длины, а также типы и значения соответствующих полей.

Хранилище кортежей, в~котором доступ к~элементам может осуществляться параллельно, называется пространством кортежей. Оно является основой языка программирования Linda. Данный язык предназначен для~построения эффективных параллельных программ. Он включает в~себя три операции манипулирования данными (кортежами):
\begin{itemize}
	\item out - запись кортежа в~пространство кортежей.
	\item rd - недеструктивное чтение кортежа.
	\item in - деструктивное чтение (извлечение) кортежа.
\end{itemize}

Шаблоном кортежа будем называть кортеж, некоторые поля которого неопределены и не представляют важности. Кортеж соответствует шаблону, если длина кортежа равна длине шаблона и определённые в~шаблоне поля совпадают по~типу и значению с~соответствующими полями кортежа. Операция записи out принимает в~качестве входного параметра кортеж, все поля которого определены. Операции чтения rd и in принимают в~качестве входного параметра шаблон кортежа, по~которому производится поиск соответствующих кортежей в~пространстве. Кроме того, операции чтения являются блокирующими, то есть если в пространстве кортежей на данный момент нет ни одного кортежа, соответствующего шаблону, то процесс, пославший запрос, заблокируется до того момента, пока в пространстве не появится подходящего кортежа.

Таким образом, пространство кортежей можно рассматривать как разновидность распределённой памяти: например, одна группа процессов записывает данные в~пространство кортежей, а другая группа процессов извлекает данные из~пространства и использует их в~своей дальнейшей работе.

Для~того, чтобы поиск кортежей в~пространстве кортежей занимал минимальное время, адресация в~нём осуществляется по~содержимому (например, с~помощью алгоритмов хэширования). Иными словами, пространство кортежей~--- реализация парадигмы ассоциативной памяти.

В~данной работе рассматривается распределённая система под~названием <<Византийское пространство кортежей>>. Основой системы является пространство кортежей, имеющее ряд особенностей, которые позволяют добиться отказоустойчивости.

\section{BTS: Византийское пространство кортежей}\label{sec:5}
Системная модель византийского пространства кортежей предполагает бесконечное число процессов-клиентов П = {p1, p2, ...}, которые взаимодействуют со множеством из n серверов U = {s1, s2, ...}, что симулирует пространство кортежей. Клиенты и серверы коммуницирует через обмен сообщениями.

Будем полагать, что случайное число клиентов и связка серверов из f<=floor((n-1)/3) штук могут быть подвержены Византийским ошибкам: они могут произвольным образом отклоняться от их спецификаций и работать в сговоре, чтобы изменить поведение системы. Такие процессы будем называть неисправными, а правильно работающие процессы~--- корректными.

Византийское пространство кортежей - это ассиметричная кворум-система, представляющая собой множество кворумов серверов $L \in 2^U$, в котором каждая пара кворумов из L пересекается на достаточно многих серверах и всегда есть кворум со всеми корректными серверами. Существование пересечений между кворумами позволяет совершенствовать протоколы чтения/записи, позволяя поддерживать целостность разделённой переменной даже если эти операции были выполнены в разных кворумах системы.

Из-за ассиметричности кворум-системы будем полагать, что  n > 3*f + 1. Кворумы делятся на два типа $(L = Lr |_| Lw)$:
\begin{itemize}
	\item чтение $(Qr \in Lr)$, состоят из ceil((n+f+1)/2) серверов,
	\item запись $(Qw \in Lw)$, состоят из ceil((n+f+1)/2) + f серверов.
\end{itemize}

Теперь опишем протоколы чтения/записи из языка Linda, но сделаем операции чтения неблокирующими. Положим, что каждый сервер s є U имеет локальную копию пространства кортежей Ts и множество кортежей для удаления Rs, при этом идентичных кортежей не существует. Тогда стандартные операции над множествами могут применяться к этим двум множествам кортежей.

\subsection{Операция записи out}\label{subsec5:1}
Вызов функции out(t) добавляет кортеж в пространство. Эта операция реализуется через алгоритм 1: /здесь будет псевдокод алгоритма 1/

При вызове данной функции клиенту p не нужно ждать ответа от серверов, будем считать, что операция завершится в тот момент, когда все корректные серверы из кворума записи получат кортеж t. Сервер добавляет кортеж t в пространство кортежей только в том случае, если этот кортеж ранее не был из него удалён. Это необходимо для того, чтобы один и тот же кортеж не был удалён дважды.

\subsection{Операция чтения rdp}\label{subsec5:2}
Недеструктивная операция чтения rdp в качестве входного параментра принимает шаблон кортежа -t, возвращает копию соответствующего шаблону кортежа из пространства. Эта операция реализуется через алгоритм 2: /здесь будет псевдокод алгоритма 2/

В реализации данной операции клиент p взаимодействует с кворумом серверов чтения, которые пытаются получить все подходящие кортежи, затем клиент выбирает из них общий кортеж t, который располагается как минимум на f+1 сервере. Если такого кортежа нет, то возвращается спецсимвол $\_\|\_$, обозначающий, что операция не увенчалась успехом. Заметим, что операция rdp не является блокирующей в отличие от её аналога rd в языке Linda.

\subsection{Операция чтения inp}\label{subsec5:3}
Операция inp является операцией деструктивного чтения, она имеет более сложную реализацию, поскольку один кортеж не может быть удалён из пространства двумя различными вызовами inp. Этот факт подразумевает использование критических секций для процессов, пытающихся удалить один и тот же кортеж, что, во-первых, обеспечит невозможность удаления кортежа двумя процессами одновременно, во-вторых, позволит всем процессам получить доступ к ресурсу в некоторое время. Операции входа в критическую секцию и выхода из неё реализуются через алгоритмы 3 и 4 соответственно: /здесь будут псевдокоды алгоритмов 3 и 4/

Для того, чтобы удалить кортеж, соответствующий шаблону -t, из пространства, серверы из кворума чтения должны принять решение, какой именно кортеж удалять. Для этой цели используется Paxos - алгоритм достижения консенсуса в распределённых системах. Операция деструктивного чтения inp реализуются через алгоритмы 5: /здесь будет псевдокод алгоритма 5/



\if 0
% Если typeOfWork в SETUP.tex задан как 2 или 3, то начинать
% надо не с section (раздел), а с главы (chapter)
\section{Несколько примеров в~\LaTeX{}}
\label{sec:examples}
\subsection{Как вставлять листинги и рисунки}
Для крупных листингов есть два способа. Первый красивый, но в нём не допускается
кириллица (у вас может встречаться в комментариях и
печатаемых сообщениях), он представлен на листинге~\ref{list:hwbeauty}.
\begin{ListingEnv}[H]% буква H означает Here, ставим здесь,
% элементы, которые нежелательно разрывать обычно не ставят
% посреди страницы: вместо H используется t (top, сверху страницы),
% или b (bottom) или p (page, на отдельной странице)
\begin{lstlisting}
#include <iostream>
using namespace std;

int main()
{
    cout << "Hello, world" << endl;
    system("pause");
    return 0;
}
\end{lstlisting}
%следующую команду для генерации подписи можно опустить,
% хотя рекомендуется все специальные элементы (таблицы, рисунки,
% листинги) подписывать. Если подпись пропустить, листинг также не получит
% номера и на него не сошлёшься в будущем
\caption{Программа “Hello, world” на \protect\cpp}
% далее метка для ссылки:
\label{list:hwbeauty}
\end{ListingEnv}

Второй не такой красивый, но без ограничений (см.~листинг~\ref{list:hwplain}).
\begin{ListingEnv}[H]
\begin{Verb}

#include <iostream>
using namespace std;

int main()
{
    cout << "Привет, мир" << endl;
}
\end{Verb}
\caption{Программа “Hello, world” без подсветки}
\label{list:hwplain}
\end{ListingEnv}

Можно использовать первый для вставки небольших фрагментов
внутри текста, а второй для вставки полного
кода в приложении, если таковое имеется.

Если нужно вставить совсем короткий пример кода (одна или две строки), то выделение  линейками и нумерация может смотреться чересчур громоздко. В таких случаях можно использовать окружения \texttt{lstlisting} или \texttt{Verb} без \texttt{ListingEnv}. Приведём такой пример с указанием языка программирования, отличного от заданного по умолчанию:
\begin{lstlisting}[language=Haskell]
fibs = 0 : 1 : zipWith (+) fibs (tail fibs)
\end{lstlisting}
Такое решение~--- со вставкой нумерованных листингов покрупнее
и вставок без выделения для маленьких фрагментов~--- выбрано,
например, в книге Эндрю Таненбаума и Тодда Остина по архитектуре
компьютера~\autocite{TanAus2013} (см.~рис.~\ref{fig:tan-aus}).

Наконец, для оформления идентификаторов внутри строк
(функция \lstinline{main} и тому подобное) используется
\texttt{lstinline} или, самое простое, моноширинный текст
(\texttt{\textbackslash texttt}).

\begin{figure}[p]% p означает, что нужно выделить для рисунка
% отдельную страницу; применяется для больших рисунков
\centering
%Здесь могла быть ваша лягушка.
\includegraphics[width=\textwidth]{img/tan-aus.png}
\caption{\label{fig:tan-aus}Пример оформления листингов в~\autocite{TanAus2013}}
\end{figure}

Использовать внешние файлы (например, рисунки) можно и на \href{http://overleaf.com}{overleaf.com}: ищите кнопочку upload.

\subsection{Как оформить таблицу}

Для таблиц обычно используются окружения table и tabular --- см. таблицу~\ref{tab:widgets}. Внутри окружения tabular используются специальные команды пакета booktabs — они очень красивые; самое главное: использование вертикальных линеек считается моветоном.

\begin{table}
\centering
\caption{\label{tab:widgets}Подпись к таблице --- сверху}
\begin{tabular}{llr}
\toprule
\multicolumn{2}{c}{Item} \\
\cmidrule(r){1-2}
Животное  & Описание    & Цена (\$) \\
\midrule
Gnat      & per gram    & 13.65      \\
          & each        & 0.01       \\
Gnu       & stuffed     & 92.50      \\
Emu       & stuffed     & 33.33      \\
Armadillo & frozen      & 8.99       \\
\bottomrule
\end{tabular}
\end{table}

\subsection{Как набирать формулы}

\LaTeX{} is great at typesetting mathematics. Let $X_1, X_2, \ldots, X_n$ be a sequence of independent and identically distributed random variables with $\text{E}[X_i] = \mu$ and $\text{Var}[X_i] = \sigma^2 < \infty$, and let
$$S_n = \frac{X_1 + X_2 + \cdots + X_n}{n}
      = \frac{1}{n}\sum_{i}^{n} X_i$$
denote their mean. Then as $n$ approaches infinity, the random variables $\sqrt{n}(S_n - \mu)$ converge in distribution to a normal $\mathcal{N}(0, \sigma^2)$.

\subsection{Как оформлять списки}

Нумерованные списки (окружение enumerate, команды item)…

\begin{enumerate}
  \item Like this,
  \item and like this.
\end{enumerate}

\dots маркированные списки \dots

\begin{itemize}
  \item Like this,
  \item and like this.
\end{itemize}

\dots списки-описания \dots

\begin{description}
  \item[Word] Definition
  \item[Concept] Explanation
  \item[Idea] Text
\end{description}

\Conc

Помните, что на все пункты списка литературы должны быть ссылки. \LaTeX\ просто не добавит информацию об издании из bib"/файла, если на это издание нет ссылки в тексте. Часто студенты используют в работе  электронные ресурсы: в этом нет ничего зазорного при одном условии: при каждом заимствовании следует ставить соответствующую ссылку. В качестве примера приведём ссылку на сайт нашего института~\autocite{mmcs}.

Для дальнейшего изучения \LaTeX\ рекомендуем книгу Львовского~\autocite{Lvo2003}: она хорошо написана, хотя и несколько устарела.
Обычно стоит искать подсказки на
\href{http://tex.stackexchange.com/}{tex.stackexchange.com}, а также
читать документацию по установленным пакетам с помощью
команды
\begin{Verb}
texdoc имя_пакета
\end{Verb}
или на \href{http://ctan.org/}{ctan.org}.

% Печать списка литературы (библиографии)
\printbibliography[%{}
    heading=bibintoc%
    %,title=Библиография % если хочется это слово
]
% Файл со списком литературы: biblio.bib
% Подробно по оформлению библиографии:
% см. документацию к пакету biblatex-gost
% http://ctan.mirrorcatalogs.com/macros/latex/exptl/biblatex-contrib/biblatex-gost/doc/biblatex-gost.pdf
% и огромное количество примеров там же:
% http://mirror.macomnet.net/pub/CTAN/macros/latex/contrib/biblatex-contrib/biblatex-gost/doc/biblatex-gost-examples.pdf

\appendix
\ifthenelse{\value{worktype} > 1}{%
  \addtocontents{toc}{%
      \protect\renewcommand{\protect\cftchappresnum}{\appendixname\space}%
      \protect\addtolength{\protect\cftchapnumwidth}{\widthof{\appendixname\space{}} - \widthof{Глава }}%
  }%
}{
  \addtocontents{toc}{%
      \protect\renewcommand{\protect\cftsecpresnum}{\appendixname\space}%
      \protect\addtolength{\protect\cftsecnumwidth}{\widthof{\appendixname\space{}}}%
  }%
}

\section{Пример работы программы}

Здесь длинный листинг с примером работы.
\fi

\end{document}
